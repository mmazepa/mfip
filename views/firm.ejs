<% include partials/header %>

    <!-- main section -->
    <main id="mainContent">

      <div class="containter-fluid">
          <div class="row">

            <% include partials/menu %>

            <div class="col-sm-9">
                <h1 class="mainHeader">
                    Profil Firmy
                    <span class="appTitle"><%= user.name %></span>!
                </h1>

                <h3>Dzień dobry, szefie!</h3>
                <p>
                    Kierowniku, jesteś zalogowany jako
                    <strong><%= user.name %></strong>.
                    Jest to Firma, którą aktualnie zarządzasz.
                    Poniżej znajdziesz wszystkie informacje, które dodałeś do
                    profilu swojej firmy.<br/>
                    <br/>
                    <span class="glyphicon glyphicon-info-sign"></span>
                    Zadbaj o to, aby każda widoczna informacja o firmie
                    była aktualna. Ułatwi to zarówno pracownikom dotarcie
                    do Twojej firmy, jak i Tobie sprawnie przeprowadzić proces
                    rekrutacji bez zbędnych nieporozumień.
                </p>

                <p>
                    <h4 class="tableHeader">
                        <span class="glyphicon glyphicon-briefcase"></span>
                        Dane Firmy
                        <button id="editFirmInfo"
                                class="btn btn-primary"
                                style="width:150px;">
                            <span class="glyphicon glyphicon-edit"></span>
                            <span id="editFirmInfoLabel">Edytuj</span>
                        </button>
                    </h4>
                    <p>
                        <table class="listTable">
                            <tr>
                                <th>Nazwa</th>
                                <th>Specjalizacja</th>
                                <th>Opis</th>
                                <th>Email</th>
                                <th>WWW</th>
                            </tr>
                            <tr>
                                <td><%= user.name %></td>
                                <td><%= user.specialization %></td>
                                <td><%= user.description %></td>
                                <td>
                                    <a href="mailto:<%= user.email %>">
                                        <%= user.email %>
                                    </a>
                                </td>
                                <td>
                                    <a href="http://<%= user.website %>">
                                        <%= user.website %>
                                    </a>
                                </td>
                            </tr>
                        </table>
                    </p>
                </p>

                <div id="firmInfoInsertion" class="insertionBox hideMe">
                    <form action="/company/update" method="POST">
                        <table>
                            <tr>
                                <th>Nazwa</th>
                                <th>Specjalizacja</th>
                                <th>Opis</th>
                                <th>
                                    E-mail
                                    <abbr title="E-mail to Twój login, pamiętaj o tym podczas jego zmiany.">
                                        <span class="glyphicon glyphicon-exclamation-sign">
                                    </abbr>
                                </th>
                                <th>WWW</th>
                            </tr>
                            <tr>
                                <input  type="text"
                                        name="id"
                                        value="<%= user.id %>"
                                        style="width:100%;"
                                        hidden/>
                                <td>
                                    <input  type="text"
                                            name="name"
                                            value="<%= user.name %>"
                                            style="width:100%;"/>
                                </td>
                                <td>
                                    <input  type="text"
                                            name="specialization"
                                            value="<%= user.specialization %>"
                                            style="width:100%;"/>
                                </td>
                                <td>
                                    <input  type="text"
                                            name="description"
                                            value="<%= user.description %>"
                                            style="width:100%;"/>
                                </td>
                                <td>
                                    <input  type="email"
                                            name="email"
                                            value="<%= user.email %>"
                                            style="width:100%;"/>
                                </td>
                                <td>
                                    <input  type="text"
                                            name="website"
                                            value="<%= user.website %>"
                                            style="width:100%;"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan=5>
                                    <marquee>Edycja informacji o firmie w toku...</marquee>
                                </td>
                            </tr>
                            <tr>
                                <td colspan=5>
                                    <button id="saveNewPersonals"
                                            class="btn btn-success"
                                            type="submit">
                                        <span class="glyphicon glyphicon-floppy-saved"></span>
                                        Zapisz nowe dane
                                    </button>
                                </td>
                            </tr>
                        </table>
                    </form>
                    <table>
                        <tr>
                            <td>
                                <!-- TODO! dodać obrazek z tej firmy!!! -->
                                <img src="/images/company.png">

                            </td>
                                <form action="/company/imageUpload" method="post" enctype="multipart/form-data">
                                    <td>
                                        <input type="file" name="imagetoupload">
                                    </td>
                                    <td>
                                        <button class="btn btn-primary" type="submit">
                                            add new image
                                        </button>
                                    </td>
                                </form>
                            </tr>
                        </table>
                </div>

                <h4 class="tableHeader">
                    <span class="glyphicon glyphicon-user"></span>
                    Pracownicy
                </h4>
                <p>
                    Firma zatrudniła
                    <strong><%= workers.length %> pracowników</strong>
                    od początku swojej działalności.
                </p>
                <p>
                    <%
                        let workersAmount = 0;
                        const countWorkers = (item, index) => {
                            if (item.to == null) workersAmount++;
                        };
                        workers.forEach(countWorkers);
                    %>
                    Aktualnie w firmie pracuje
                    <strong><%= workersAmount %> pracowników</strong>.
                </p>
                <p>
                    Pracę w naszej firmie zakończyło
                    <strong><%= workers.length-workersAmount %> pracowników</strong>.
                </p>
                <p>
                    <table class="listTable">
                        <tr>
                            <th>L.P.</th>
                            <th>Imię</th>
                            <th>Nazwisko</th>
                            <th>Stanowisko</th>
                            <th>W firmie od</th>
                            <th>W firmie do</th>
                            <th>E-mail</th>
                            <th>Zwolnij</th>
                        </tr>
                        <%
                            if (workers != null) {
                                for (w in workers) {
                        %>
                            <tr>
                                <td><%= parseInt(w)+1 %></td>
                                <td><%= workers[w].first_name %></td>
                                <td><%= workers[w].last_name %></td>
                                <td><%= workers[w].workstation %></td>
                                <td class="date"><%= workers[w].from %></td>
                                <td class="date"><%= workers[w].to %></td>
                                <td>
                                    <a href="mailto:<%= workers[w].email %>">
                                        <%= workers[w].email %>
                                    </a>
                                </td>
                                <td>
                        <%
                                    if (workers[w].to == null) {
                        %>
                                    <button class="btn btn-danger"
                                            onclick="location.replace('/fireWorker/boss/<%= user.id %>/<%= workers[w].id %>')">
                                        <span class="glyphicon glyphicon-log-out"></span>
                                    </button>
                        <%
                                    }
                        %>
                                </td>
                            </tr>
                        <%
                                }
                            }
                        %>
                    </table>
                </p>
            </div>
          </div>
      </div>
    </main>

    <% include partials/footer %>
  </body>
</html>
